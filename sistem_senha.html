<script>
  let contadorComum = 0;
  let contadorPrioritaria = 0;
  const maxSenha = 1000;
  const listaChamadas = [];

  const senhaAtualEl = document.getElementById('senhaAtual');
  const listaChamadasEl = document.getElementById('listaChamadas');

  function gerarSenha(tipo) {
    if (tipo === 'P') {
      contadorPrioritaria++;
      if (contadorPrioritaria > maxSenha) contadorPrioritaria = 1;
      return 'P' + contadorPrioritaria.toString().padStart(3, '0');
    } else {
      contadorComum++;
      if (contadorComum > maxSenha) contadorComum = 1;
      return 'C' + contadorComum.toString().padStart(3, '0');
    }
  }

  function chamarSenha(tipo) {
    const senha = gerarSenha(tipo);
    senhaAtualEl.textContent = senha;
    listaChamadas.unshift(senha); 
    atualizarLista();
    falarSenha(senha); // Chama a função de voz aqui
  }

  function atualizarLista() {
    listaChamadasEl.innerHTML = '';
    for(let i = 0; i < listaChamadas.length; i++) {
      const li = document.createElement('li');
      li.textContent = listaChamadas[i];
      listaChamadasEl.appendChild(li);
    }
  }

  // ✅ FALA A SENHA
  function falarSenha(senha) {
    const utterance = new SpeechSynthesisUtterance();
    utterance.lang = 'pt-BR';
    utterance.rate = 1;

    if (senha.startsWith("P")) {
      utterance.text = "Senha prioritária " + formatarNumeros(senha.slice(1));
    } else {
      utterance.text = "Senha comum " + formatarNumeros(senha.slice(1));
    }

    speechSynthesis.speak(utterance);
  }

  function formatarNumeros(numero) {
    return numero.split('').join(', ');
  }

  document.getElementById('btnPrioritaria').addEventListener('click', () => chamarSenha('P'));
  document.getElementById('btnNormal').addEventListener('click', () => chamarSenha('C'));
</script>
